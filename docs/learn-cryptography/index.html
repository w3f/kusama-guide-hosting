<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-learn/learn-cryptography" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Cryptography on Polkadot Â· Guide</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://guide.kusama.network/docs/learn-cryptography"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Cryptography on Polkadot Â· Guide"><meta data-rh="true" name="description" content="Cryptographic Functions used in Polkadot."><meta data-rh="true" property="og:description" content="Cryptographic Functions used in Polkadot."><meta data-rh="true" name="keywords" content="cryptography,hashing,keypair,signing,keys,randomness,verifiable random function,VDF"><link data-rh="true" rel="icon" href="/img/Kusama_Canary_white.png"><link data-rh="true" rel="canonical" href="https://guide.kusama.network/docs/learn-cryptography"><link data-rh="true" rel="alternate" href="https://guide.kusama.network/docs/learn-cryptography" hreflang="en"><link data-rh="true" rel="alternate" href="https://guide.kusama.network/docs/learn-cryptography" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://33KMAMG2DG-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Guide" href="/opensearch.xml">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Muli&display=swap">
<script src="https://buttons.github.io/buttons.js"></script>
<script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.js"></script>
<script src="https://unpkg.com/vanilla-back-to-top@7.2.1/dist/vanilla-back-to-top.min.js" onload="addBackToTop()" defer="defer"></script>
<script src="https://apisa.kusama.network/latest.js" async defer="defer"></script>
<script src="../js/custom.js"></script>
<script src="../js/clipboard.min.js"></script>
<script src="../js/copycode.js"></script><link rel="stylesheet" href="/assets/css/styles.dd7fb8ad.css">
<link rel="preload" href="/assets/js/runtime~main.161af186.js" as="script">
<link rel="preload" href="/assets/js/main.d3bff339.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:#e6007a;color:white" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">The Polkadot Blockchain Academy is coming to Asia! <a href="https://www.polkadot.network/development/academy/?utm_source=guide.kusama.network&utm_medium=referral&utm_campaign=pba%204%205&utm_content=notification" target="_blank" rel="noopener noreferrer">Find out more ðŸ‘‰</a></div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/Kusama_logotype_white_large.png" alt="" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/Kusama_logotype_white_large.png" alt="" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Guide</b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/kusama-getting-started">Docs</a><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div><a class="navbar__item navbar__link" href="/docs/contributing">Contribute</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/docs/learn-cryptography" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li><li><a href="https://crowdin.com/project/polkadot-wiki" target="_blank" rel="noopener noreferrer" class="dropdown__link">Help us translate</a></li></ul></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><main class="docMainContainer_gTbr docMainContainerEnhanced_Uz_u"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Cryptography on Polkadot</h1></header><p>This is a high-level overview of the cryptography used in Polkadot. It assumes that you have some
knowledge about cryptographic primitives that are generally used in blockchains such as hashes,
elliptic curve cryptography (ECC), and public-private keypairs.</p><p>For detailed descriptions on the cryptography used in Polkadot please see the more advanced
<a href="https://research.web3.foundation" target="_blank" rel="noopener noreferrer">research wiki</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="hashing-algorithm">Hashing Algorithm<a href="#hashing-algorithm" class="hash-link" aria-label="Direct link to Hashing Algorithm" title="Direct link to Hashing Algorithm">â€‹</a></h2><p>The hashing algorithm used in Polkadot is
<a href="https://en.wikipedia.org/wiki/BLAKE_(hash_function)#BLAKE2" target="_blank" rel="noopener noreferrer">Blake2b</a>. Blake2 is considered to be
a very fast cryptographic hash function that is also used in the cryptocurrency
<a href="https://z.cash" target="_blank" rel="noopener noreferrer">Zcash</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="keypairs-and-signing">Keypairs and Signing<a href="#keypairs-and-signing" class="hash-link" aria-label="Direct link to Keypairs and Signing" title="Direct link to Keypairs and Signing">â€‹</a></h2><p>Polkadot uses Schnorrkel/Ristretto x25519 (&quot;sr25519&quot;) as its key derivation and signing algorithm.</p><p>Sr25519 is based on the same underlying <a href="https://en.wikipedia.org/wiki/Curve25519" target="_blank" rel="noopener noreferrer">Curve25519</a> as
its EdDSA counterpart, <a href="https://en.wikipedia.org/wiki/EdDSA#Ed25519" target="_blank" rel="noopener noreferrer">Ed25519</a>. However, it uses
Schnorr signatures instead of the EdDSA scheme. Schnorr signatures bring some noticeable benefits
over the ECDSA/EdDSA schemes. For one, it is more efficient and still retains the same feature set
and security assumptions. Additionally, it allows for native multisignature through
<a href="https://bitcoincore.org/en/2017/03/23/schnorr-signature-aggregation/" target="_blank" rel="noopener noreferrer">signature aggregation</a>.</p><p>The names Schnorrkel and Ristretto come from the two Rust libraries that implement this scheme, the
<a href="https://github.com/w3f/schnorrkel" target="_blank" rel="noopener noreferrer">Schnorrkel</a> library for Schnorr signatures and the
<a href="https://ristretto.group/ristretto.html" target="_blank" rel="noopener noreferrer">Ristretto</a> library that makes it possible to use cofactor-8
curves like Curve25519.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="keys">Keys<a href="#keys" class="hash-link" aria-label="Direct link to Keys" title="Direct link to Keys">â€‹</a></h2><p>Public and private keys are an important aspect of most crypto-systems and an essential component
that enables blockchains like Kusama to
exist.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="account-keys">Account Keys<a href="#account-keys" class="hash-link" aria-label="Direct link to Account Keys" title="Direct link to Account Keys">â€‹</a></h3><p>Account keys are keys that are meant to control funds. They can be either:</p><ul><li>The vanilla <code>ed25519</code> implementation using Schnorr signatures.</li><li>The Schnorrkel/Ristretto <code>sr25519</code> variant using Schnorr signatures.</li><li>ECDSA signatures on secp256k1</li></ul><p>There are no differences in security between <code>ed25519</code> and <code>sr25519</code> for simple signatures. We
expect <code>ed25519</code> to be much better supported by commercial HSMs for the foreseeable future. At the
same time, <code>sr25519</code> makes implementing more complex protocols safer. In particular, <code>sr25519</code> comes
with safer version of many protocols like HDKD common in the Bitcoin and Ethereum ecosystem.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="stash-and-staking-proxy-keys">Stash and Staking Proxy Keys<a href="#stash-and-staking-proxy-keys" class="hash-link" aria-label="Direct link to Stash and Staking Proxy Keys" title="Direct link to Stash and Staking Proxy Keys">â€‹</a></h3><p>When we talk about stash and staking proxy keys, we usually talk about them in the context of
running a validator or nominating, but they are useful concepts for all users to know. Both keys are
types of account keys. They are distinguished by their intended use, not by an underlying
cryptographic difference. All the info mentioned in the parent section applies to these keys. When
creating new staking proxy or stash keys, all cryptography supported by account keys are an
available option.</p><p>The staking proxy key is a semi-online key that will be in the direct control of a user, and used to
submit manual extrinsics. For validators or nominators, this means that the proxy key will be used
to start or stop validating or nominating. Proxy keys should hold some
KSM to pay for fees, but they should not be used
to hold huge amounts or life savings. Since they will be exposed to the internet with relative
frequency, they should be treated carefully and occasionally replaced with new ones.</p><p>The stash key is a key that will, in most cases, be a cold wallet, existing on a piece of paper in a
safe or protected by layers of hardware security. It should rarely, if ever, be exposed to the
internet or used to submit extrinsics. The stash key is intended to hold a large amount of funds. It
should be thought of as a saving&#x27;s account at a bank, which ideally is only ever touched in urgent
conditions. Or, perhaps a more apt metaphor is to think of it as buried treasure, hidden on some
random island and only known by the pirate who originally hid it.</p><p>Since the stash key is kept offline, it must be set to have its funds bonded to a particular staking
proxy. For non-spending actions, the staking proxy has the funds of the stash behind it. For
example, in nominating, staking, or voting, the proxy can indicate its preference with the weight of
the stash. It will never be able to actually move or claim the funds in the stash key. However, if
someone does obtain your proxy key, they could use it for slashable behavior, so you should still
protect it and change it regularly.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="session-keys">Session Keys<a href="#session-keys" class="hash-link" aria-label="Direct link to Session Keys" title="Direct link to Session Keys">â€‹</a></h3><p>Session keys are hot keys that must be kept online by a validator to perform network operations.
Session keys are typically generated in the client, although they don&#x27;t have to be. They are <em>not</em>
meant to control funds and should only be used for their intended purpose. They can be changed
regularly; your staking proxy only need create a certificate by signing a session public key and
broadcast this certificate via an extrinsic.</p><p>Kusama uses six session keys:</p><ul><li>Authority Discovery: sr25519</li><li>GRANDPA: ed25519</li><li>BABE: sr25519</li><li>I&#x27;m Online: sr25519</li><li>Parachain Assignment: sr25519</li><li>Parachain Validator: ed25519</li></ul><p>BABE requires keys suitable for use in a <a href="#vrf">Verifiable Random Function</a> as well as for digital
signatures. Sr25519 keys have both capabilities and so are used for BABE.</p><p>In the future, we plan to use a BLS key for GRANDPA because it allows for more efficient signature
aggregation.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="faq-about-keys">FAQ about Keys<a href="#faq-about-keys" class="hash-link" aria-label="Direct link to FAQ about Keys" title="Direct link to FAQ about Keys">â€‹</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="why-was-ed25519-selected-over-secp256k1">Why was <code>ed25519</code> selected over <code>secp256k1</code>?<a href="#why-was-ed25519-selected-over-secp256k1" class="hash-link" aria-label="Direct link to why-was-ed25519-selected-over-secp256k1" title="Direct link to why-was-ed25519-selected-over-secp256k1">â€‹</a></h4><p>The original key derivation cryptography that was implemented for
Kusama and Substrate chains was <code>ed25519</code>,
which is a Schnorr signature algorithm implemented over the Edward&#x27;s Curve 25519 (so named due to
the parameters of the curve equation).</p><p>Most cryptocurrencies, including Bitcoin and Ethereum, currently use ECDSA signatures on the
secp256k1 curve. This curve is considered much more secure than NIST curves, which
<a href="#appendix-a-on-the-security-of-curves">have possible backdoors from the NSA</a>. The Curve25519 is
considered possibly <em>even more</em> secure than this one and allows for easier implementation of Schnorr
signatures. A recent patent expiration on it has made it the preferred choice for use in
Kusama.</p><p>The choice of using Schnorr signatures over using ECDSA is not so cut and dried. Jeff Burdges (a
Web3 researcher) provides additional details on the decision in this
<a href="https://research.web3.foundation/Polkadot/security/keys" target="_blank" rel="noopener noreferrer">research post</a> on the topic:</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Choosing Schnorr signatures over ECDSA signatures</div><div class="admonitionContent_S0QG"><p>There is one sacrifice we make by choosing Schnorr signatures over ECDSA signatures for account
keys: Both require 64 bytes, but only ECDSA signatures communicate their public key. There are
obsolete Schnorr variants that support recovering the public key from a signature, but they break
important functionality like hierarchical deterministic key derivation. In consequence, Schnorr
signatures often take an extra 32 bytes for the public key.</p></div></div><p>But ultimately the benefits of using Schnorr signatures outweigh the tradeoffs, and future
optimizations may resolve the inefficiencies pointed out in the quote above.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-sr25519-and-where-did-it-come-from">What is <code>sr25519</code> and where did it come from?<a href="#what-is-sr25519-and-where-did-it-come-from" class="hash-link" aria-label="Direct link to what-is-sr25519-and-where-did-it-come-from" title="Direct link to what-is-sr25519-and-where-did-it-come-from">â€‹</a></h4><p>Some context: The Schnorr signatures over the Twisted Edward&#x27;s Curve25519 are considered secure,
however Ed25519 has not been completely devoid of its bugs. Most notably,
<a href="https://www.getmonero.org/2017/05/17/disclosure-of-a-major-bug-in-cryptonote-based-currencies.html" target="_blank" rel="noopener noreferrer">Monero and all other CryptoNote currencies</a>
were vulnerable to a double spend exploit that could have potentially led to undetected, infinite
inflation.</p><p>These exploits were due to one peculiarity in Ed25519, which is known as its cofactor of 8. The
cofactor of a curve is an esoteric detail that could have dire consequences for the security of
implementation of more complex protocols.</p><p>Conveniently, <a href="https://www.shiftleft.org/papers/decaf/index.xhtml" target="_blank" rel="noopener noreferrer">Mike Hamburg&#x27;s Decaf paper</a>
provides a possible path forward to solving this potential bug. Decaf is basically a way to take
Twisted Edward&#x27;s Curves cofactor and mathematically change it with little cost to performance and
gains to security.</p><p>The Decaf paper approach by the <a href="https://ristretto.group/" target="_blank" rel="noopener noreferrer">Ristretto Group</a> was extended and
implemented in Rust to include cofactor-8 curves like the Curve25519 and makes Schnorr signatures
over the Edward&#x27;s curve more secure.</p><p>Web3 Foundation has implemented a Schnorr signature library using the more secure Ristretto
compression over the Curve25519 in the <a href="https://github.com/w3f/schnorrkel" target="_blank" rel="noopener noreferrer">Schnorrkel</a> repository.
Schnorrkel implements related protocols on top of this curve compression such as HDKD, MuSig, and a
verifiable random function (VRF). It also includes various minor improvements such as the hashing
scheme STROBE that can theoretically process huge amounts of data with only one call across the Wasm
boundary.</p><p>The implementation of Schnorr signatures that is used in Polkadot and implements the Schnorrkel
protocols over the Ristretto compression of the Curve25519 is known as <strong>sr25519</strong>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="are-bls-signatures-used-in-polkadot">Are BLS signatures used in Polkadot?<a href="#are-bls-signatures-used-in-polkadot" class="hash-link" aria-label="Direct link to Are BLS signatures used in Polkadot?" title="Direct link to Are BLS signatures used in Polkadot?">â€‹</a></h4><p>Not yet, but they will be. BLS signatures allow more efficient signature aggregation. Because
GRANDPA validators are usually signing the same thing (e.g. a block), it makes sense to aggregate
them, which can allow for other protocol optimizations.</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>From the BLS library&#x27;s README</div><div class="admonitionContent_S0QG"><p>Boneh-Lynn-Shacham (BLS) signatures have slow signing, very slow verification, require slow and much
less secure pairing friendly curves, and tend towards dangerous malleability. Yet, BLS permits a
diverse array of signature aggregation options far beyond any other known signature scheme, which
makes BLS a preferred scheme for voting in consensus algorithms and for threshold signatures.</p></div></div><p>Even though Schnorr signatures allow for signature aggregation, BLS signatures are much more
efficient in some fashions. For this reason it will be one of the session keys that will be used by
validators on the Polkadot network and critical to the GRANDPA finality gadget.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="randomness">Randomness<a href="#randomness" class="hash-link" aria-label="Direct link to Randomness" title="Direct link to Randomness">â€‹</a></h2><p>Randomness in Proof of Stake blockchains is important for a fair and unpredictable distribution of
validator responsibilities. Computers are bad at random numbers because they are deterministic
devices (the same input always produces the same output). What people usually call random numbers on
a computer (such as in a gaming application), are <em>pseudo-random</em> - that is, they depend on a
sufficiently random <em>seed</em> provided by the user or another type of <em>oracle</em>, like a
<a href="https://www.random.org/randomness/" target="_blank" rel="noopener noreferrer">weather station for atmospheric noise</a>, your
<a href="https://mdpi.altmetric.com/details/47574324" target="_blank" rel="noopener noreferrer">heart rate</a>, or even
<a href="https://en.wikipedia.org/wiki/Lavarand" target="_blank" rel="noopener noreferrer">lava lamps</a>, from which it can generate a series of
seemingly-random numbers. But given the same seed, the same sequence will always be generated.</p><p>Though, these inputs will vary based on time and space, and it would be impossible to get the same
result into all the nodes of a particular blockchain around the world. If nodes get different inputs
on which to build blocks, forks happen. Real-world entropy is not suitable for use as a seed for
blockchain randomness.</p><p>There are two main approaches to blockchain randomness in production today: <code>RANDAO</code> and <code>VRF</code>.
Kusama uses VRF.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="vrf">VRF<a href="#vrf" class="hash-link" aria-label="Direct link to VRF" title="Direct link to VRF">â€‹</a></h3><p>A verifiable random function (VRF) is a mathematical operation that takes some input and produces a
random number along with a proof of authenticity that this random number was generated by the
submitter. The proof can be verified by any challenger to ensure the random number generation is
valid.</p><p>The VRF used in Kusama is roughly the same
as the one used in Ouroboros Praos. Ouroboros randomness is secure for block production and works
well for <a href="/docs/learn-consensus#BABE">BABE</a>. Where they differ is that Polkadot&#x27;s VRF does not depend
on a central clock (the problem becomes - whose central clock?), rather, it depends on its own past
results to determine present and future results, and it uses slot numbers as a clock emulator,
estimating time.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="heres-how-it-works-in-detail">Here&#x27;s how it works in detail:<a href="#heres-how-it-works-in-detail" class="hash-link" aria-label="Direct link to Here&#x27;s how it works in detail:" title="Direct link to Here&#x27;s how it works in detail:">â€‹</a></h4><p>Slots are discrete units of time six seconds in length. Each slot can contain a block, but may not.
Slots make up <a href="/docs/glossary##epoch">epochs</a> - on
Kusama, 2400 slots make one epoch, which
makes epochs four hours long.</p><p>In every slot, each validator &quot;rolls a die&quot;. They execute a function (the VRF) that takes as input
the following:</p><ul><li><strong>The &quot;secret key&quot;,</strong> a key specifically made for these die rolls.</li><li><strong>An epoch randomness value,</strong> which is the hash of VRF values from the blocks in the epoch before
last (N-2), so past randomness affects the current pending randomness (N).</li><li><strong>The slot number.</strong></li></ul><p><img loading="lazy" alt="VRF_babe" src="/assets/images/VRF_babe-12768d3392ba939b5f4c4955556d12c2.png" width="1685" height="564" class="img_ev3q"></p><p>The output is two values: a <code>RESULT</code> (the random value) and a <code>PROOF</code> (a proof that the random value
was generated correctly).</p><p>The <code>RESULT</code> is then compared to a <em>threshold</em> defined in the implementation of the protocol
(specifically, in the Kusama Host). If the
value is less than the threshold, then the validator who rolled this number is a viable block
production candidate for that slot. The validator then attempts to create a block and submits this
block into the network along with the previously obtained <code>PROOF</code> and <code>RESULT</code>. Under VRF, every
validator rolls a number for themselves, checks it against a threshold, and produces a block if the
random roll is under that threshold.</p><p>The astute reader will notice that due to the way this works, some slots may have no validators as
block producer candidates because all validator candidates rolled too high and missed the threshold.
We clarify how we resolve this issue and make sure that
Kusama block times remain near constant-time
in the wiki page on <a href="/docs/learn-consensus">consensus</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="randao">RANDAO<a href="#randao" class="hash-link" aria-label="Direct link to RANDAO" title="Direct link to RANDAO">â€‹</a></h3><p>An alternative method for getting randomness on-chain is the
<a href="https://github.com/randao/randao" target="_blank" rel="noopener noreferrer">RANDAO</a> method from Ethereum. RANDAO requires each validator to
prepare by performing many thousands of hashes on some seed. Validators then publish the final hash
during a round and the random number is derived from every participant&#x27;s entry into the game. As
long as one honest validator participates, the randomness is considered secure (non-economically
viable to attack). RANDAO is optionally augmented with VDF.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="vdfs">VDFs<a href="#vdfs" class="hash-link" aria-label="Direct link to VDFs" title="Direct link to VDFs">â€‹</a></h3><p><a href="https://vdfresearch.org/" target="_blank" rel="noopener noreferrer">Verifiable Delay Functions</a> are computations that take a prescribed
duration of time to complete, even on parallel computers. They produce unique output that can be
independently and efficiently verified in a public setting. By feeding the result of RANDAO into a
VDF, a delay is introduced that renders any attacker&#x27;s attempt at influencing the current randomness
obsolete.</p><p>VDFs will likely be implemented through ASIC devices that need to be run separately from the other
types of nodes. Although only one is enough to keep the system secure, and they will be open source
and distributed at nearly no charge, running them is neither cheap nor incentivized, producing
unnecessary friction for users of the blockchains opting for this method.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="resources">Resources<a href="#resources" class="hash-link" aria-label="Direct link to Resources" title="Direct link to Resources">â€‹</a></h2><ul><li><a href="https://web.archive.org/web/20210513183118/https://forum.w3f.community/t/key-recovery-attack-on-bip32-ed25519/44" target="_blank" rel="noopener noreferrer">Key discovery attack on BIP32-Ed25519</a> -
Archive of forum post detailing a potential attack on BIP32-Ed25519. A motivation for transition
to the sr25519 variant.</li><li><a href="https://research.web3.foundation/Polkadot/security/keys" target="_blank" rel="noopener noreferrer">Account signatures and keys in Polkadot</a> -
Research post by Web3 researcher Jeff Burdges.</li><li><a href="https://bitcoin.stackexchange.com/questions/57965/are-schnorr-signatures-quantum-computer-resistant/57977#57977" target="_blank" rel="noopener noreferrer">Are Schnorr signatures quantum computer resistant?</a></li><li><a href="https://research.web3.foundation/Polkadot/protocols/block-production" target="_blank" rel="noopener noreferrer">Polkadot&#x27;s research on blockchain randomness and sortition</a> -
contains reasoning for choices made along with proofs</li><li><a href="https://github.com/paritytech/ink/issues/57" target="_blank" rel="noopener noreferrer">Discussion on Randomness used in Polkadot</a> - W3F
researchers discuss the randomness in Polkadot and when it is usable and under which assumptions.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="appendix-a-on-the-security-of-curves">Appendix A: On the security of curves<a href="#appendix-a-on-the-security-of-curves" class="hash-link" aria-label="Direct link to Appendix A: On the security of curves" title="Direct link to Appendix A: On the security of curves">â€‹</a></h2><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>From the</div><div class="admonitionContent_S0QG"><p><a href="https://git.libssh.org/projects/libssh.git/tree/doc/curve25519-sha256@libssh.org.txt#n10" target="_blank" rel="noopener noreferrer">Introduction of Curve25519</a>
into <code>libssl</code></p><p>The reason is the following: During summer of 2013, revelations from ex- consultant at <!-- -->[the]<!-- --> NSA
Edward Snowden gave proof that <!-- -->[the]<!-- --> NSA willingly inserts backdoors into software, hardware
components and published standards. While it is still believed that the mathematics behind ECC
(Elliptic-curve cryptography) are still sound and solid, some people (including Bruce Schneier
<!-- -->[SCHNEIER]<!-- -->), showed their lack of confidence in NIST-published curves such as nistp256, nistp384,
nistp521, for which constant parameters (including the generator point) are defined without
explanation. It is also believed that <!-- -->[the]<!-- --> NSA had a word to say in their definition. These curves
are not the most secure or fastest possible for their key sizes <!-- -->[DJB]<!-- -->, and researchers think it is
possible that NSA have ways of cracking NIST curves. It is also interesting to note that SSH belongs
to the list of protocols the NSA claims to be able to eavesdrop. Having a secure replacement would
make passive attacks much harder if such a backdoor exists.</p><p>However an alternative exists in the form of Curve25519. This algorithm has been proposed in 2006 by
DJB <!-- -->[Curve25519]<!-- -->. Its main strengths are its speed, its constant-time run time (and resistance
against side-channel attacks), and its lack of nebulous hard-coded constants.</p></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2023-09-12T14:46:37.000Z">Sep 12, 2023</time></b> by <b>Filippo</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#hashing-algorithm" class="table-of-contents__link toc-highlight">Hashing Algorithm</a></li><li><a href="#keypairs-and-signing" class="table-of-contents__link toc-highlight">Keypairs and Signing</a></li><li><a href="#keys" class="table-of-contents__link toc-highlight">Keys</a><ul><li><a href="#account-keys" class="table-of-contents__link toc-highlight">Account Keys</a></li><li><a href="#stash-and-staking-proxy-keys" class="table-of-contents__link toc-highlight">Stash and Staking Proxy Keys</a></li><li><a href="#session-keys" class="table-of-contents__link toc-highlight">Session Keys</a></li><li><a href="#faq-about-keys" class="table-of-contents__link toc-highlight">FAQ about Keys</a></li></ul></li><li><a href="#randomness" class="table-of-contents__link toc-highlight">Randomness</a><ul><li><a href="#vrf" class="table-of-contents__link toc-highlight">VRF</a></li><li><a href="#randao" class="table-of-contents__link toc-highlight">RANDAO</a></li><li><a href="#vdfs" class="table-of-contents__link toc-highlight">VDFs</a></li></ul></li><li><a href="#resources" class="table-of-contents__link toc-highlight">Resources</a></li><li><a href="#appendix-a-on-the-security-of-curves" class="table-of-contents__link toc-highlight">Appendix A: On the security of curves</a></li></ul></div></div></div></div></main></div></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/Kusama_Canary_white.png" alt="Guide" width="66" height="58"></a><div><a href="https://kusama.network/" target="_blank" class="homepage-font">Kusama Network</a><a href="https://polkadot.network/faq/" target="_blank" rel="noreferrer noopener" class="homepage-font">FAQ</a><a href="https://twitter.com/kusamanetwork" target="_blank" rel="noreferrer noopener" class="homepage-font">Twitter</a><a href="https://www.notion.so/web3foundation/Polkadot-Kusama-Community-Hub-ee1fd077ff6c42c381940404f6aa9f1c" target="_blank" rel="noreferrer noopener" class="homepage-font">Community Hub</a><a href="https://kusa.ma/discord" target="_blank" rel="noreferrer noopener" class="homepage-font">Kusama Discord</a><a href="https://matrix.to/#/!HfRYKXBoPmDBCAWUEJ:polkadot.builders" target="_blank" rel="noreferrer noopener" class="homepage-font">Kusama Watercooler</a><a href="https://web3.foundation/grants/" target="_blank" rel="noreferrer noopener" class="homepage-font">Grants and Bounties</a></div><div class="kusama-mainpage-cyber-row"><div class="kusama-mainpage-column"><h2 class="homepage-font-footer">Join a cyber secret society</h2><p class="homepage-font-footer">The Kappa Sigma Mu fraternity asks you to get a Kusama tattoo to join.</p><a href="/docs/maintain-guides-society-kusama"><button class="kusama-mainpage-build-footer">See Kappa Sigma Mu</button></a></div></div></section><section class="row"><div class="copyright homepage-font">Â© 2023 Web3 Foundation</div>Â·<a target="_blank" rel="noreferrer noopener" class="item homepage-font" href="https://polkadot.network/legal-disclosures/">Legal Disclosures</a>Â·<a target="_blank" rel="noreferrer noopener" class="item homepage-font" href="https://polkadot.network/privacy/">Privacy Policy</a></section></footer></div>
<script src="/assets/js/runtime~main.161af186.js"></script>
<script src="/assets/js/main.d3bff339.js"></script>
</body>
</html>