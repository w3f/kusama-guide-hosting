<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-general/dune-analytics/dunesql-cheatsheet" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">DuneSQL Cheatsheet · Guide</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://guide.kusama.network/docs/general/dunesql-cheatsheet"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="DuneSQL Cheatsheet · Guide"><meta data-rh="true" name="description" content="A brief comparison of common features between DuneSQL and Common SQL."><meta data-rh="true" property="og:description" content="A brief comparison of common features between DuneSQL and Common SQL."><meta data-rh="true" name="keywords" content="polkadot,dashboard,dune,sql,dunesql"><link data-rh="true" rel="icon" href="/img/Kusama_Canary_white.png"><link data-rh="true" rel="canonical" href="https://guide.kusama.network/docs/general/dunesql-cheatsheet"><link data-rh="true" rel="alternate" href="https://guide.kusama.network/docs/general/dunesql-cheatsheet" hreflang="en"><link data-rh="true" rel="alternate" href="https://guide.kusama.network/docs/general/dunesql-cheatsheet" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://33KMAMG2DG-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Guide" href="/opensearch.xml">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Muli&display=swap">
<script src="https://buttons.github.io/buttons.js"></script>
<script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.js"></script>
<script src="https://unpkg.com/vanilla-back-to-top@7.2.1/dist/vanilla-back-to-top.min.js" onload="addBackToTop()" defer="defer"></script>
<script src="https://apisa.kusama.network/latest.js" async defer="defer"></script>
<script src="../js/custom.js"></script>
<script src="../js/clipboard.min.js"></script>
<script src="../js/copycode.js"></script><link rel="stylesheet" href="/assets/css/styles.56e6bf55.css">
<script src="/assets/js/runtime~main.f14f1991.js" defer="defer"></script>
<script src="/assets/js/main.f06a6c91.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/Kusama_logotype_white_large.png" alt="" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/Kusama_logotype_white_large.png" alt="" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Guide</b></a></div><div class="navbar__items navbar__items--right"><a href="https://wiki.polkadot.network/docs/kusama-getting-started" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div><a href="https://wiki.polkadot.network/docs/contributing" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Contribute<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><main class="docMainContainer_TBSr docMainContainerEnhanced_lQrH"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="theme-doc-markdown markdown"><header><h1>DuneSQL Cheatsheet</h1></header>
<p>It is important to note that when querying on Dune Analytics, DuneSQL is employed. Although most
functions and syntax are similar to standard SQL, there are still some differences compared to other
versions of SQL. Below is a comparison table of common features between DuneSQL and Google BigQuery
SQL.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>DuneSQL Reference</div><div class="admonitionContent_BuS1"><p>For more information on DuneSQL, please refer to the
<a href="https://docs.dune.com/query-engine/Functions-and-operators/index" target="_blank" rel="noopener noreferrer">DuneSQL documentation</a>.</p></div></div>
<table><thead><tr><th>Problem Type</th><th>BigQuery</th><th>DuneSQL(V2)</th><th>Description</th></tr></thead><tbody><tr><td>JSON Reading Method</td><td><code>JSON_EXTRACT_SCALAR(call_args, &quot;$.remark&quot;)</code></td><td><code>JSON_EXTRACT_SCALAR(JSON_PARSE(call_args), &#x27;$.remark&#x27;)</code></td><td>In DuneSQL, <code>JSON_PARSE</code> is needed to split the JSON if it is initially not in JSON format but is transformed into a JSON string.</td></tr><tr><td>JSON array to SQL array</td><td><code>JSON_EXTRACT_ARRAY(JSON_EXTRACT(pv, &#x27;$.others&#x27;))</code></td><td><code>cast(json_extract(pv, &#x27;$.others&#x27;) as array&lt;json&gt;)</code></td><td>BigQuery uses a function for this conversion, while DuneSQL utilizes casting and supports the JSON data type.</td></tr><tr><td>HEX to UTF8</td><td><code>SAFE_CONVERT_BYTES_TO_STRING(FROM_HEX(SUBSTR(hex_encode, 3)))</code></td><td><code>FROM_UTF8(from_hex(SUBSTR(hex_encode, 3)))</code></td><td>In DuneSQL, the <code>SAFE_CONVERT_BYTES_TO_STRING</code> is not required.</td></tr><tr><td>Time Series</td><td><code>TIMESTAMP_TRUNC(block_time, DAY) &gt;= TIMESTAMP(&quot;2023-12-01&quot;)</code></td><td><code>block_time &gt;= date(&#x27;2023-12-01&#x27;)</code></td><td>Time conversion in DuneSQL is simpler, involving direct usage of <code>variable operator date(value)</code>.</td></tr><tr><td>Data Type Conversion (FLOAT64 to DOUBLE)</td><td><code>CAST(JSON_EXTRACT_SCALAR(nominationpools_rewardpools, &#x27;$.lastRecordedRewardCounter&#x27;) AS FLOAT64)</code></td><td><code>CAST(JSON_EXTRACT_SCALAR(nominationpools_rewardpools, &#x27;$.lastRecordedRewardCounter&#x27;)</code></td><td>BigQuery refers to the data format as FLOAT64, while in DuneSQL, it is termed DOUBLE.</td></tr><tr><td>Handling Null Values</td><td><code>IFNULL(prev_member_bonded, 0)</code></td><td><code>COALESCE(prev_member_bonded, 0)</code></td><td>In DuneSQL, BigQuery&#x27;s <code>IFNULL</code> is equivalent to <code>COALESCE</code>.</td></tr><tr><td>Calculating Local Time and Subtracting Days</td><td><code>TIMESTAMP_TRUNC(ts, DAY) &gt;= TIMESTAMP(DATE_SUB(CURRENT_DATE(), INTERVAL 30 DAY))</code></td><td><code>ts &gt;= date(current_date - interval &#x27;30&#x27; day)</code></td><td>In BigQuery, operations on dates require functions, but DuneSQL allows direct use of <code>+</code> and <code>-</code>.</td></tr><tr><td>Using Hyperlinks in Tables</td><td><code>SELECT concat(concat(concat(&quot;&lt;a href=&#x27;https://analytics.polkaholic.io/superset/dashboard/77/?account=&quot;, address_ss58), &quot;&#x27;&gt;&quot;), if(address_name is null, concat(address_ss58, &#x27;&lt;/a&gt;&#x27;), concat(address_name, &#x27;&lt;/a&gt;&#x27;)))</code></td><td><code>CONCAT(&#x27;&lt;a target=&quot;_new&quot; href=&quot;https://analytics.polkaholic.io/superset/dashboard/77/?account=&#x27;, address_ss58, &#x27;&quot;&gt;&#x27;, address_ss58 ,&#x27;&lt;/a&gt;&#x27;) AS address_ss58</code></td><td>DuneSQL enables string concatenation using <code>CONCAT</code>, making it straightforward compared to the multiple <code>concat</code> functions required in BigQuery.</td></tr></tbody></table></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2024-06-24T07:55:16.000Z" itemprop="dateModified">Jun 24, 2024</time></b> by <b>MK</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"></nav></div></div></div></div></main></div></div></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/Kusama_Canary_white.png" alt="Guide" width="66" height="58"></a><div><a href="https://kusama.network/" target="_blank" class="homepage-font">Kusama Network</a><a href="https://polkadot.network/faq/" target="_blank" rel="noreferrer noopener" class="homepage-font">FAQ</a><a href="https://twitter.com/kusamanetwork" target="_blank" rel="noreferrer noopener" class="homepage-font">Twitter</a><a href="https://www.notion.so/web3foundation/Polkadot-Kusama-Community-Hub-ee1fd077ff6c42c381940404f6aa9f1c" target="_blank" rel="noreferrer noopener" class="homepage-font">Community Hub</a><a href="https://kusa.ma/discord" target="_blank" rel="noreferrer noopener" class="homepage-font">Kusama Discord</a><a href="https://matrix.to/#/!HfRYKXBoPmDBCAWUEJ:polkadot.builders" target="_blank" rel="noreferrer noopener" class="homepage-font">Kusama Watercooler</a><a href="https://web3.foundation/grants/" target="_blank" rel="noreferrer noopener" class="homepage-font">Grants and Bounties</a></div><div class="kusama-mainpage-cyber-row"><div class="kusama-mainpage-column"><h2 class="homepage-font-footer">Join a cyber secret society</h2><p class="homepage-font-footer">The Kappa Sigma Mu fraternity asks you to get a Kusama tattoo to join.</p><a href="https://wiki.polkadot.network/docs/maintain-guides-society-kusama"><button class="kusama-mainpage-build-footer">See Kappa Sigma Mu</button></a></div></div></section><section class="row"><div class="copyright homepage-font">© 2024 Web3 Foundation</div>·<a target="_blank" rel="noreferrer noopener" class="item homepage-font" href="https://polkadot.network/legal-disclosures/">Legal Disclosures</a>·<a target="_blank" rel="noreferrer noopener" class="item homepage-font" href="https://polkadot.network/privacy/">Privacy Policy</a></section></footer></div>
</body>
</html>