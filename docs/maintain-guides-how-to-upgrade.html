<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-maintain/maintain-guides-how-to-upgrade" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">How to Upgrade Your Validator · Guide</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://guide.kusama.network/docs/maintain-guides-how-to-upgrade"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="How to Upgrade Your Validator · Guide"><meta data-rh="true" name="description" content="Validators perform critical functions for the network by"><meta data-rh="true" property="og:description" content="Validators perform critical functions for the network by"><meta data-rh="true" name="keywords" content="upgrade,node,validator,release,session"><link data-rh="true" rel="icon" href="/img/Kusama_Canary_white.png"><link data-rh="true" rel="canonical" href="https://guide.kusama.network/docs/maintain-guides-how-to-upgrade"><link data-rh="true" rel="alternate" href="https://guide.kusama.network/docs/maintain-guides-how-to-upgrade" hreflang="en"><link data-rh="true" rel="alternate" href="https://guide.kusama.network/docs/maintain-guides-how-to-upgrade" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://33KMAMG2DG-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Guide" href="/opensearch.xml">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Muli&display=swap">
<script src="https://buttons.github.io/buttons.js"></script>
<script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.js"></script>
<script src="https://unpkg.com/vanilla-back-to-top@7.2.1/dist/vanilla-back-to-top.min.js" onload="addBackToTop()" defer="defer"></script>
<script src="https://apisa.kusama.network/latest.js" async defer="defer"></script>
<script src="../js/custom.js"></script>
<script src="../js/clipboard.min.js"></script>
<script src="../js/copycode.js"></script><link rel="stylesheet" href="/assets/css/styles.56e6bf55.css">
<script src="/assets/js/runtime~main.763641aa.js" defer="defer"></script>
<script src="/assets/js/main.789c1309.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/Kusama_logotype_white_large.png" alt="" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/Kusama_logotype_white_large.png" alt="" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Guide</b></a></div><div class="navbar__items navbar__items--right"><a href="https://wiki.polkadot.network/docs/kusama-getting-started" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div><a href="https://wiki.polkadot.network/docs/contributing" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Contribute<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><main class="docMainContainer_TBSr docMainContainerEnhanced_lQrH"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>How to Upgrade Your Validator</h1></header><p>Validators perform critical functions for the network by
<a href="/docs/learn-parachains-protocol">backing and including blocks</a>. Validators may have to go
offline for short-periods of time to upgrade client software or to upgrade the host machine.
Usually, standard client upgrades will only require you to stop the service, replace the binary and
restart the service. This operation can be executed within a session.</p>
<p>Validators may also need to perform long-lead maintenance tasks that will span more than one
session. Under these circumstances, an active validator may chill their stash and be removed from
the active validator set. Alternatively, the validator may substitute the active validator server
with another allowing the former to undergo maintenance activities.</p>
<p>This guide will provide an option for validators to seamlessly substitute an active validator server
to allow for maintenance operations.</p>
<p>The process can take several hours, so make sure you understand the instructions first and plan
accordingly.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Keep an eye out on new releases from the community</div><div class="admonitionContent_BuS1"><p>Upgrade or downgrade accordingly.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="key-components">Key Components<a href="#key-components" class="hash-link" aria-label="Direct link to Key Components" title="Direct link to Key Components">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="session-keys">Session Keys<a href="#session-keys" class="hash-link" aria-label="Direct link to Session Keys" title="Direct link to Session Keys">​</a></h3>
<p>Session keys are stored in the client and used to sign validator operations. They are what link your
validator node to your staking proxy. If you change them within a session you will have to wait for
the current session to finish and a further two sessions to elapse before they are applied.</p>
<p><a href="/docs/learn-cryptography">More info about keys in Polkadot.</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="keystore">Keystore<a href="#keystore" class="hash-link" aria-label="Direct link to Keystore" title="Direct link to Keystore">​</a></h3>
<p>Each validator server contains essential private keys in a folder called the <em>keystore</em>. These keys
are used by a validator to sign transactions at the network level. If two or more validators sign
certain transactions using the same keys, it can lead to an
<a href="/docs/learn-offenses">equivocation slash</a>.</p>
<p>For this reason, it is advised that validators DO NOT CLONE or COPY the <em>keystore</em> folder and
instead generate session keys for each new validator instance.</p>
<p>Default keystore path - <code>/home/polkadot/.local/share/polkadot/chains/&lt;chain&gt;/keystore</code></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="steps">Steps<a href="#steps" class="hash-link" aria-label="Direct link to Steps" title="Direct link to Steps">​</a></h2>
<p>The following steps require a second validator which will be referred to as <code>Validator B</code>; the
original server that is in the active set will be referred to as <code>Validator A</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="session-n">Session <code>N</code><a href="#session-n" class="hash-link" aria-label="Direct link to session-n" title="Direct link to session-n">​</a></h3>
<ol>
<li>Start a second node. Once it is synced, use the <code>--validator</code> flag. This is now &quot;Validator B.&quot;</li>
<li>Generate Session keys for <strong>Validator B</strong>.</li>
<li>Submit a <code>set_key</code> extrinsic from your staking proxy with the session key generated from
<strong>Validator B</strong>.</li>
<li>Take note of the Session that this extrinsic was executed in.</li>
<li>Allow the current session to elapse and then wait for two full sessions.</li>
</ol>
<p><strong>It is imperative that you keep Validator A running during this time.</strong> <code>set_key</code> does not have an
immediate effect and requires two full sessions to elapse before it does. If you do switch off
Validator A too early you may risk being chilled and face a fault within the Thousand Validator
Programme.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="session-n3">Session <code>N+3</code><a href="#session-n3" class="hash-link" aria-label="Direct link to session-n3" title="Direct link to session-n3">​</a></h3>
<p><strong>Validator B</strong> is now acting as your validator - you can safely perform operations on <strong>Validator
A</strong>.</p>
<p>When you are ready to restore <strong>Validator A</strong>:</p>
<ol>
<li>Start <strong>Validator A</strong>, sync the database and ensure that it is operating with the <code>--validator</code>
flag.</li>
<li>Generate new Session keys for <strong>Validator A</strong>.</li>
<li>Submit a <code>set_key</code> extrinsic from your staking proxy with the session key generated from
<strong>Validator A</strong>.</li>
<li>Take note of the Session that this extrinsic was executed in.</li>
</ol>
<p><strong>Again, it is imperative that Validator B is kept running until the current session finishes and
two further full sessions have elapsed.</strong></p>
<p>Once this time has elapsed, <strong>Validator A</strong> will take over. You can safely stop Validator B.</p>
<p><strong>NOTE:</strong> To verify that the Session has changed, make sure that a block in the new Session is
finalized. You should see log messages like the ones below to confirm the change:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">2019-10-28 21:44:13 Applying authority set change scheduled at block #450092</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2019-10-28 21:44:13 Applying GRANDPA set change to new set with 20 authorities</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2024-06-10T14:13:41.000Z" itemprop="dateModified">Jun 10, 2024</time></b> by <b>Filippo</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#key-components" class="table-of-contents__link toc-highlight">Key Components</a><ul><li><a href="#session-keys" class="table-of-contents__link toc-highlight">Session Keys</a></li><li><a href="#keystore" class="table-of-contents__link toc-highlight">Keystore</a></li></ul></li><li><a href="#steps" class="table-of-contents__link toc-highlight">Steps</a><ul><li><a href="#session-n" class="table-of-contents__link toc-highlight">Session <code>N</code></a></li><li><a href="#session-n3" class="table-of-contents__link toc-highlight">Session <code>N+3</code></a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/Kusama_Canary_white.png" alt="Guide" width="66" height="58"></a><div><a href="https://kusama.network/" target="_blank" class="homepage-font">Kusama Network</a><a href="https://polkadot.network/faq/" target="_blank" rel="noreferrer noopener" class="homepage-font">FAQ</a><a href="https://twitter.com/kusamanetwork" target="_blank" rel="noreferrer noopener" class="homepage-font">Twitter</a><a href="https://www.notion.so/web3foundation/Polkadot-Kusama-Community-Hub-ee1fd077ff6c42c381940404f6aa9f1c" target="_blank" rel="noreferrer noopener" class="homepage-font">Community Hub</a><a href="https://kusa.ma/discord" target="_blank" rel="noreferrer noopener" class="homepage-font">Kusama Discord</a><a href="https://matrix.to/#/!HfRYKXBoPmDBCAWUEJ:polkadot.builders" target="_blank" rel="noreferrer noopener" class="homepage-font">Kusama Watercooler</a><a href="https://web3.foundation/grants/" target="_blank" rel="noreferrer noopener" class="homepage-font">Grants and Bounties</a></div><div class="kusama-mainpage-cyber-row"><div class="kusama-mainpage-column"><h2 class="homepage-font-footer">Join a cyber secret society</h2><p class="homepage-font-footer">The Kappa Sigma Mu fraternity asks you to get a Kusama tattoo to join.</p><a href="https://wiki.polkadot.network/docs/maintain-guides-society-kusama"><button class="kusama-mainpage-build-footer">See Kappa Sigma Mu</button></a></div></div></section><section class="row"><div class="copyright homepage-font">© 2024 Web3 Foundation</div>·<a target="_blank" rel="noreferrer noopener" class="item homepage-font" href="https://polkadot.network/legal-disclosures/">Legal Disclosures</a>·<a target="_blank" rel="noreferrer noopener" class="item homepage-font" href="https://polkadot.network/privacy/">Privacy Policy</a></section></footer></div>
</body>
</html>